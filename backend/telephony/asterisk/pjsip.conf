; ============================================================================
; PJSIP Configuration for VCA Platform - Tata SIP Trunk Integration
; ============================================================================
;
; ⚠️  WARNING: SECURITY CRITICAL - DO NOT COMMIT REAL CREDENTIALS
; ============================================================================
; This file contains PLACEHOLDER credentials only. In production:
; 1. Replace ALL placeholder values with real credentials
; 2. Store this file OUTSIDE the git repository (e.g., /etc/asterisk/)
; 3. Use secure credential management (vault, secrets manager, etc.)
; 4. Restrict file permissions: chmod 600 pjsip.conf
; 5. Never commit real credentials to version control
; ============================================================================
;
; PURPOSE:
; This configuration establishes SIP trunk connectivity between Asterisk
; and Tata SIP service for inbound call routing to the VCA platform.
;
; ARCHITECTURE:
; Tata SIP --> Asterisk (this config) --> VCA Platform (FastAPI endpoint)
;
; For production deployment documentation, see BACKEND_README.md

; ============================================================================
; TRANSPORT CONFIGURATION
; ============================================================================
; Defines how Asterisk listens for SIP traffic

[transport-udp]
type=transport
protocol=udp
bind=0.0.0.0:5060
; TODO: Production - bind to specific interface IP, not 0.0.0.0
; TODO: Production - consider TLS transport for security
external_media_address=YOUR_PUBLIC_IP
external_signaling_address=YOUR_PUBLIC_IP
; TODO: Production - replace YOUR_PUBLIC_IP with actual public IP/hostname

[transport-tcp]
type=transport
protocol=tcp
bind=0.0.0.0:5060
; TODO: Production - enable if Tata requires TCP transport

; ============================================================================
; TATA SIP TRUNK ENDPOINT
; ============================================================================
; Defines connection to Tata SIP service

[tata-trunk]
type=endpoint
context=from-tata-trunk
; ⚠️  Security: This context name must match extensions.conf
disallow=all
allow=ulaw,alaw,g729
; TODO: Production - verify codecs supported by Tata SIP
; TODO: Production - adjust codec priority based on Tata recommendations

; Authentication
aors=tata-trunk
auth=tata-trunk-auth
outbound_auth=tata-trunk-auth

; Media handling
direct_media=no
; ⚠️  Important: direct_media=no ensures media flows through Asterisk
; This is required for call recording and monitoring

rtp_symmetric=yes
force_rport=yes
rewrite_contact=yes
; These settings help with NAT traversal

; Call identification
trust_id_inbound=yes
; TODO: Production - review security implications of trust_id_inbound

; ============================================================================
; TATA SIP TRUNK ADDRESS OF RECORD (AOR)
; ============================================================================
; Defines where to reach Tata SIP servers

[tata-trunk]
type=aor
contact=sip:TATA_SIP_SERVER_IP:5060
; ⚠️  TODO: Replace TATA_SIP_SERVER_IP with actual Tata SIP server address
; ⚠️  TODO: Obtain this from Tata SIP service documentation

; Registration settings (if required by Tata)
; TODO: Production - uncomment and configure if Tata requires registration
; qualify_frequency=60
; maximum_expiration=3600
; minimum_expiration=60

; ============================================================================
; TATA SIP TRUNK AUTHENTICATION
; ============================================================================
; Credentials for authenticating with Tata SIP service

[tata-trunk-auth]
type=auth
auth_type=userpass
username=YOUR_TATA_USERNAME
; ⚠️  CRITICAL: Replace YOUR_TATA_USERNAME with real username from Tata
password=YOUR_TATA_PASSWORD
; ⚠️  CRITICAL: Replace YOUR_TATA_PASSWORD with real password from Tata
; ⚠️  SECURITY: Use a secrets management system in production
realm=TATA_SIP_REALM
; ⚠️  TODO: Replace TATA_SIP_REALM with actual realm from Tata documentation

; ============================================================================
; IDENTIFY CONFIGURATION
; ============================================================================
; Identifies incoming calls from Tata SIP servers

[tata-identify]
type=identify
endpoint=tata-trunk
match=TATA_SIP_SERVER_IP
; ⚠️  TODO: Replace TATA_SIP_SERVER_IP with actual Tata server IP
; ⚠️  TODO: Add all Tata SIP server IPs if they use multiple servers
; Example: match=203.0.113.1,203.0.113.2,203.0.113.3

; ============================================================================
; PRODUCTION DEPLOYMENT CHECKLIST
; ============================================================================
; Before deploying to production, ensure:
;
; [ ] All placeholder credentials replaced with real values
; [ ] File stored outside git repository (/etc/asterisk/pjsip.conf)
; [ ] File permissions set to 600 (readable only by asterisk user)
; [ ] Firewall rules configured for SIP (UDP/TCP 5060) and RTP (UDP 10000-20000)
; [ ] Network address translation (NAT) properly configured
; [ ] Tata SIP server IPs whitelisted in firewall
; [ ] SIP trunk tested with Tata support team
; [ ] Codec settings verified with Tata recommendations
; [ ] Call quality monitoring enabled
; [ ] Logging configured for troubleshooting
;
; ⚠️  For security best practices, see BACKEND_README.md
